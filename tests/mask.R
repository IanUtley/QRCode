testMatrix<-matrix(c(
 1,1,1,1,1,1,1,0,1,0,0,1,0,0,1,1,1,1,1,1,1,
 1,0,0,0,0,0,1,0,1,1,0,0,1,0,1,0,0,0,0,0,1,
 1,0,1,1,1,0,1,0,0,1,1,1,1,0,1,0,1,1,1,0,1,
 1,0,1,1,1,0,1,0,0,1,1,1,1,0,1,0,1,1,1,0,1,
 1,0,1,1,1,0,1,0,0,1,0,0,0,0,1,0,1,1,1,0,1,
 1,0,0,0,0,0,1,0,0,1,1,1,1,0,1,0,0,0,0,0,1,
 1,1,1,1,1,1,1,0,1,0,1,0,1,0,1,1,1,1,1,1,1,
 0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,
 0,1,0,0,0,0,1,1,1,1,1,0,1,1,0,0,0,0,0,1,1,
 1,0,1,1,1,1,0,1,0,0,0,0,1,1,1,1,0,1,1,1,0,
 0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,1,0,1,0,0,1,
 1,0,1,1,1,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,
 1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,
 0,0,0,0,0,0,0,0,1,0,0,0,1,1,1,1,0,1,0,1,1,
 1,1,1,1,1,1,1,0,1,1,0,0,0,0,1,0,1,1,1,0,1,
 1,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,1,0,1,1,1,
 1,0,1,1,1,0,1,0,0,1,0,0,0,0,0,0,0,1,1,1,0,
 1,0,1,1,1,0,1,0,0,0,0,0,1,0,0,0,0,1,1,0,0,
 1,0,1,1,1,0,1,0,0,1,0,1,1,0,1,0,0,0,0,1,1,
 1,0,0,0,0,0,1,0,1,1,1,0,1,0,0,1,0,0,1,0,1,
 1,1,1,1,1,1,1,0,0,1,1,0,1,1,0,0,1,0,0,0,0
), nrow = 21, ncol = 21, byrow = TRUE)

source("../mask.R")
message(sprintf("Penalty 1 was %03d expected 189", PenaltyCount1(testMatrix)))
message(sprintf("Penalty 2 was %03d expected 156", PenaltyCount2(testMatrix)))
message(sprintf("Penalty 3 was %03d expected 200", PenaltyCount3(testMatrix)))

# Note the reference document has incorrect image
message(sprintf("Penalty 4 was %03d expected 002", PenaltyCount4(testMatrix)))
